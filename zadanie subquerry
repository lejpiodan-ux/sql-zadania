Analiza średnich cen produktów w bazie danych Ogólnodostępnej bazy danych (Northwind)

Celem analizy było obliczenie średniej ceny jednostkowej produktów w poszczególnych kategoriach, a następnie sklasyfikowanie każdej kategorii jako Expensive, Normal lub Cheap na podstawie wartości średniej ceny. Dodatkowo do zestawienia dałem aktualną datę wykonania zapytania.

Opis rozwiązania  
W zapytaniu wykorzystano tabele:

- Products  
- Categories  

Oraz techniki:

`INNER JOIN` `do połączenia tabel Products i Categories,  
- AVG() do obliczenia średniej ceny jednostkowej produktów w każdej kategorii,  
- GROUP BY do grupowania wyników według kategorii,  
- HAVING do porównania średnich cen z globalną średnią wszystkich produktów,  
- CASE do klasyfikacji kategorii jako Expensive, Normal lub Cheap,  
- CAST(GETDATE() AS DATE) do pobrania bieżącej daty bez czasu,  
- ORDER BY do posortowania wyników malejąco według średniej ceny.  

Rezultat zapisanego kodu  
Zapytanie zwraca listę kategorii wraz z ich średnią ceną jednostkową, statusem wartości produktu (na podstawie przedziałów cenowych) oraz aktualną datą wykonania analizy.  
Wyniki są posortowane od najwyższej do najniższej średniej ceny produktów.

Projekt SQL wykonany jako część portfolio analityka danych.  
Autor: Piotr Leja
